# Routines 应用更新日志

## 版本历史

### [未发布] - 2025年7月

#### 新增功能
- **图片查看器** - 2025-07-20 15:30
  - 添加全屏图片查看功能
  - 支持双击缩放、手势缩放、拖拽移动
  - 支持多图浏览和左右滑动切换
  - 添加页码显示和重置按钮
  - 在编辑模式和预览模式下均可点击图片查看

#### 功能修复
- **数据存储优化** - 2025-07-20 15:20
  - 修复 NSUserDefaults 数据过大错误（超过4MB限制）
  - 将数据存储从 NSUserDefaults 迁移到文件系统
  - 添加数据迁移功能，自动迁移旧数据
  - 优化数据加载和保存性能
  - 添加数据清理和错误处理

- **撤销/重做功能** - 2025-07-20 14:45
  - 修复编译错误：`Type 'UIResponder' has no member 'undo'`
  - 修复编译错误：`Cannot assign to property: 'undoManager' is a get-only property`
  - 实现系统级撤销/重做功能
  - 添加状态跟踪和调试日志
  - 支持中文输入法的撤销/重做操作

#### 技术改进
- **Markdown渲染器** - 2025-07-20 13:20
  - 修复 SwiftUI 'buildExpression' 错误
  - 修复 Swift 6 正则表达式语法错误
  - 改进表格渲染，移除行间间隙
  - 优化行内格式解析（加粗、斜体、删除线、链接等）
  - 添加代码块和行内代码支持

#### 界面优化
- **内容编辑器** - 2025-07-20 12:15
  - 添加 Markdown 工具栏
  - 实现工具栏按钮样式应用到选中文本
  - 添加图片上传按钮
  - 优化预览/编辑模式切换
  - 改进全屏任务列表显示

#### 项目文档
- **统一更新日志** - 2025-07-20 15:45
  - 创建 CHANGELOG.md 统一记录所有功能更新
  - 删除分散的功能文档，保持项目结构整洁
  - 添加详细的功能分类和时间记录
  - 更新 README.md 添加文档链接

### [初始版本] - 2025年7月

#### 核心功能
- **时间管理应用** - 2025-07-20 10:00
  - 四个时间维度管理（日/周/月/年）
  - Markdown 内容编辑和预览
  - 图片添加和管理
  - 数据持久化存储
  - 现代化 SwiftUI 界面

#### 基础架构
- **数据模型** - 2025-07-20 09:30
  - ContentItem 数据模型
  - 支持标题、Markdown内容、图片数据
  - 创建时间和更新时间跟踪

- **数据管理** - 2025-07-20 09:15
  - DataManager 服务类
  - JSON 格式数据持久化
  - 自动保存和加载功能

- **视图结构** - 2025-07-20 09:00
  - 主界面 ContentView
  - 四个时间维度视图（DailyView、WeeklyView、MonthlyView、YearlyView）
  - 内容编辑器 ContentEditor
  - 添加内容界面 AddContentView
  - 设置界面 SettingsView

## 技术栈

### 前端
- **SwiftUI** - 现代化声明式UI框架
- **UIKit** - 通过 UIViewRepresentable 集成
- **PhotosUI** - 图片选择和上传

### 后端
- **Foundation** - 基础框架
- **JSON** - 数据序列化
- **FileManager** - 文件系统操作

### 开发工具
- **Swift 6** - 编程语言
- **Xcode** - 开发环境
- **Git** - 版本控制

## 功能特性总览

### ✅ 已完成功能
- [x] 四个时间维度管理
- [x] Markdown 内容编辑和预览
- [x] 图片添加和管理
- [x] 图片全屏查看器
- [x] 撤销/重做功能
- [x] 数据持久化存储
- [x] 现代化 SwiftUI 界面
- [x] Markdown 工具栏
- [x] 代码块和行内代码支持
- [x] 表格渲染
- [x] 链接和引用支持

### 🔄 进行中功能
- 无

### 📋 计划功能
- [ ] 图片编辑功能（裁剪、滤镜）
- [ ] 图片分享功能
- [ ] 数据导出/导入
- [ ] 主题切换
- [ ] 搜索功能
- [ ] 标签系统
- [ ] 提醒功能
- [ ] 数据同步

## 已知问题

### 已修复
- ✅ SwiftUI 'buildExpression' 编译错误
- ✅ Swift 6 正则表达式语法错误
- ✅ UIResponder.undo 方法不存在错误
- ✅ undoManager 只读属性赋值错误
- ✅ 撤销/重做功能无效问题

### 待解决
- 无

## 开发规范

### 代码风格
- 使用 Swift 官方代码风格
- 函数和变量使用驼峰命名法
- 常量使用大写字母和下划线
- 添加适当的注释和文档

### 提交规范
- 每次功能更新记录在 CHANGELOG.md 中
- 包含日期时间和详细描述
- 分类记录（新增功能、修复、改进等）

### 测试要求
- 新功能需要经过编译测试
- 重要功能需要功能测试
- 界面变化需要视觉测试

## 版本发布计划

### 当前版本
- **版本号**: 1.0.0
- **状态**: 开发中
- **目标**: 基础功能完善

### 下一版本
- **版本号**: 1.1.0
- **计划**: 图片编辑和分享功能
- **预计时间**: 2025年7月底

---

*最后更新: 2025-07-20 15:20*
*维护者: Mclarenlife* 